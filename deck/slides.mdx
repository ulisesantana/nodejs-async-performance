import {CodeSurfer} from "code-surfer";
import { github } from "@code-surfer/themes"
import {Split, Steps, Footer} from 'mdx-deck'
import {Layout, ProfileImage, LeanMind, Row, GlobalStyle, FluidContainer, Footer as SlideFooter} from "./components";
import {isPortrait} from "./helpers"

import nodeJsLogo from "./assets/images/node-js-logo.svg"
import lumberjackImage from "./assets/images/lumberjack.jpeg"
import ulises from "./assets/images/ulises.webp"
import matteo from "./assets/images/matteo.jpg"
import james from "./assets/images/james.jpg"
import mocha from "./assets/images/mocha-puppy.jpg"
import nullTheCat from "./assets/images/null.jpg"
import mochaAndNull from "./assets/images/mocha-and-null.jpg"

import coffinDance from "./assets/gifs/coffin-dance.gif"
import sheldonBag from "./assets/gifs/sheldon-bag.gif"
import pickleRick from "./assets/gifs/pickle-rick.gif"

import uselessAsync from "./assets/screenshots/useless-async.png"

export const theme = {
  styles: GlobalStyle
}

<Footer>
  <SlideFooter/>
</Footer>

## Cómo pasé un proceso en

<img 
  src={nodeJsLogo} 
  style={{height: '30vmin', float: 'right', position: 'relative'}} 
  alt="Node.js logo"
/>

## de 5 horas a 5 minutos

---

<FluidContainer style={{
  alignContent: 'center',
  justifyContent: isPortrait() ? 'center' : 'space-around' ,
  textAlign: isPortrait() ? 'center' : 'right',
  width: '100%'
}}>
  <ProfileImage
    src={ulises}
    size="75vmin"
    alt="Foto de Ulises Santana"
  />

  <div style={{
    alignItems: isPortrait() ? 'center' : 'end',
    display: 'flex',
    flexDirection: 'column',
    justifyContent: 'center'
  }}>

  ## Ulises Santana

  Full Stack Developer en

  <LeanMind size="50vmin"/>

  </div>


</FluidContainer>


---

<Row alignCenter>
  <img
    src={mocha}
    alt="Mi perra Mocha"
    style={{height: '40vmin', transform: 'rotate(-15deg)'}}
  />
  <img
    src={nullTheCat}
    alt="Mi gato Null"
    style={{height: '40vmin', transform: 'rotate(15deg)'}}
  />
</Row>

<img
  src={mochaAndNull}
  alt="Mocha y Null siendo felices"
  style={{height: '40vmin'}}
/>


---

<Layout>

  # Contexto

  1. Se iba a rehacer un proyecto desde cero y habían modificaciones en varios más.
  1. No todo el equipo controlaba la tecnología en la que se estaba trabajando.
  1. El deadline es fijo y crítico, ya que rompemos el cash flow de la empresa en caso de retrasarnos.

</Layout>


---

<Layout>

  # *Dame 6 horas para cortar un árbol y pasaré 4 afilando el hacha*

</Layout>


---

## El Proyecto Leñador

<img
  src={lumberjackImage}
  alt="Ulises vestido de leñador con hacha en mano"
  style={{height: '50vmin'}}
/>


---

<Layout>

  ## Prototipo original:

  ~7 minutos

  <Steps>
    <div>
      <h2>Proyecto Leñador:</h2>
      <p
        style={{
          color: 'red',
          fontWeight: 'bold',
          textDecoration: "underline"
        }}
      >
        5 horas 7 minutos y 54 segundos
      </p>
    </div>
  </Steps>

</Layout>


---

<h1
  style={{
    fontSize: '20vw',
    color: 'red'
  }}
>
  + 4400%
</h1>


---
<img
  src={coffinDance}
  alt="Gif de los bailarines del ataúd (Coffin dance)"
  style={{
    width: '80vw'
  }}
/>



---

# Deadline: 10 días

<Steps>
  <h1 style={{textDecoration: 'underline'}}>NATURALES</h1>
</Steps>



---

<FluidContainer>
  <ProfileImage
    src={matteo}
    alt="Foto de Matteo Collina"
    size="60vmin"
  />

  <ProfileImage
    src={james}
    alt="Foto de James Snell"
    size="60vmin"
  />
</FluidContainer>


---

<FluidContainer>
  <img
    src={sheldonBag}
    alt="Gif de Sheldon respirando en una bolsa de papel"
    style={{
      width: '45vw'
    }}  
  />
  <img
    src={pickleRick}
    alt="Gif de Pickle Rick agonizando bajo el sol"
    style={{
      width: '35vw'
    }}
  />
</FluidContainer>


---

# 1. Evita async innecesarios


---

<CodeSurfer theme={github}>

  ```js
  export function syncIteration(amountOfExecutions, task) {
    for (let i = 0; i < amountOfExecutions; i++) {
      task()
    }
  }

  export async function asyncIteration(amountOfExecutions, task) {
    for (let i = 0; i < amountOfExecutions; i++) {
      await task()
    }
  }
  ```

  ```diff 1:5
  ```

  ```diff 1[8:56]
  ```

  ```diff 1[31:48]
  ```

  ```diff 1[50:54]
  ```

  ```diff 2,4
  ```

  ```diff 3
  ```

  ```diff 7:11
  ```

  ```diff 7[8:13],9
  ```

  ```javascript
  function randomNumber() {
    const x = Math.random()
    return x ** x
  }
  ```

</CodeSurfer>


---

<img
  src={uselessAsync}
  alt="Resultado demo useless-async"
  style={{width: '95%'}}
/>


---

# 2. Evita los await dentro de los bucles


---

# 3. Usa Promise.all siempre que puedas


---

# 4. Sé consciente de cuantas promesas estás gestionando


---

# 5. Los async iterators pueden ser maravillosos


---

# 6. Cachear queries


---

# 7. Haz caso de los warnings


---

<CodeSurfer theme={github}>

  ```shell
  (node) warning: possible EventEmitter memory leak detected.
  11 listeners added.
  Use emitter.setMaxListeners() to increase limit.
  ```

</CodeSurfer>


---

<CodeSurfer>


  ```js showNumbers
  console.log(1);
  console.log(2);
  console.log(3);
  ```

  ```diff 1
  ```

  ```diff 2
  ```

  ```diff 3
  ```

</CodeSurfer>


---

# Documentación

- [Componentes de MDX Deck](https://github.com/jxnblk/mdx-deck/blob/73b90eb9a353d300cc9e5ddf3070bb6868298275/docs/components.md)
- [Layout de MDX Deck](https://github.com/jxnblk/mdx-deck/blob/73b90eb9a353d300cc9e5ddf3070bb6868298275/docs/layouts.md)
- [Code Surfer](https://codesurfer.pomb.us)

