import {CodeSurfer} from "code-surfer";
import {Split, Appear} from 'mdx-deck'
import {Footer, Layout, ProfileImage, LeanMind, Row} from "./components";
import {isPortrait} from "./helpers"

import nodeJsLogo from "./assets/node-js-logo.svg"
import lumberjackImage from "./assets/lumberjack.jpeg"
import ulises from "./assets/ulises.webp"
import matteo from "./assets/matteo.jpg"
import james from "./assets/james.jpg"
import mocha from "./assets/mocha-puppy.jpg"
import nullTheCat from "./assets/null.jpg"
import mochaAndNull from "./assets/mocha-and-null.jpg"

import coffinDance from "./assets/gifs/coffin-dance.gif"
import sheldonBag from "./assets/gifs/sheldon-bag.gif"
import pickleRick from "./assets/gifs/pickle-rick.gif"

import uselessAsync from "./assets/screenshots/useless-async.png"

## Cómo pasé un proceso en

<img src={nodeJsLogo} style={{height: '30vmin'}} alt="Node.js logo"/>

## de 5 horas a 5 minutos


<Footer/>

---

<div style={{
  alignContent: 'center',
  display: 'flex',
  justifyContent: isPortrait() ? 'center' : 'space-around' ,
  flexWrap: 'wrap',
  textAlign: isPortrait() ? 'center' : 'right',
  width: '100%'
}}>
  <ProfileImage
    src={ulises}
    size="75vmin"
    alt="Foto de Ulises Santana"
  />

  <div style={{
    alignContent: 'flex-end',
    display: 'flex',
    flexDirection: 'column',
    justifyContent: 'center'
  }}>

  ## Ulises Santana

  Full Stack Developer en

  <LeanMind size="50vmin"/>

  </div>


</div>

<Footer/>

---

<Row alignCenter>
  <img
    src={mocha}
    alt="Mi perra Mocha"
    style={{height: '40vmin', transform: 'rotate(-15deg)'}}
  />
  <img
    src={nullTheCat}
    alt="Mi gato Null"
    style={{height: '40vmin', transform: 'rotate(15deg)'}}
  />
</Row>

<img
  src={mochaAndNull}
  alt="Mocha y Null siendo felices"
  style={{height: '40vmin'}}
/>

<Footer/>

---

<Layout>

  # Contexto

  <Appear>
    <ol>
      <li>
        No todo el equipo controlaba la tecnología en la que se estaba
        trabajando.
      </li>
      <li>
        El deadline es fijo y crítico, ya que rompemos el cash flow de la
        empresa en caso de retrasarnos.
      </li>
    </ol>
  </Appear>

</Layout>

<Footer/>

---

<Layout>

  # *Dame 6 horas para cortar un árbol y pasaré 4 afilando el hacha*

</Layout>

<Footer/>

---

## El Proyecto Leñador

<img
  src={lumberjackImage}
  alt="Ulises vestido de leñador con hacha en mano"
  style={{height: '50vmin'}}
/>

<Footer/>

---

<Layout>

  ## Prototipo original:

  ~7 minutos

  <Appear>
    <div>
      <h2>Proyecto Leñador:</h2>
      <p
        style={{
          color: 'red',
          fontWeight: 'bold',
          textDecoration: "underline"
        }}
      >
        5 horas 7 minutos y 54 segundos
      </p>
    </div>
  </Appear>

</Layout>

<Footer/>

---

<h1
  style={{
    fontSize: '20vw',
    color: 'red'
  }}
>
  + 4400%
</h1>

<Footer/>

---
<img
  src={coffinDance}
  alt="Gif de los bailarines del ataúd (Coffin dance)"
  style={{
    width: '80vw'
  }}
/>


<Footer/>

---

# Deadline: 10 días

<Appear>
  <h1 style={{textDecoration: 'underline'}}>NATURALES</h1>
</Appear>


<Footer/>

---

<Row alignCenter>
  <ProfileImage
    src={matteo}
    alt="Foto de Matteo Collina"
    size="60vmin"
  />

  <ProfileImage
    src={james}
    alt="Foto de James Snell"
    size="60vmin"
  />
</Row>

<Footer/>

---

<Row>
  <img
    src={sheldonBag}
    alt="Gif de Sheldon respirando en una bolsa de papel"
    width="800px"
  />
  <img
    src={pickleRick}
    alt="Gif de Pickle Rick agonizando bajo el sol"
    width="600px"
  />
</Row>

<Footer/>

---

# 1. Evita async innecesarios

<Footer/>

---

<CodeSurfer>

  ```javascript
  export function syncIteration(amountOfExecutions, task) {
    for (let i = 0; i < amountOfExecutions; i++) {
      task()
    }
  }

  export async function asyncIteration(amountOfExecutions, task) {
    for (let i = 0; i < amountOfExecutions; i++) {
      await task()
    }
  }
  ```

  ```diff 1:5
  ```

  ```diff 1[8:56]
  ```

  ```diff 1[31:48]
  ```

  ```diff 1[50:54]
  ```

  ```diff 2,4
  ```

  ```diff 3
  ```

  ```diff 7:11
  ```

  ```diff 7[8:13],9
  ```

  ```javascript
  function randomNumber() {
    const x = Math.random()
    return x ** x
  }
  ```

</CodeSurfer>

<Footer/>

---

<img
  src={uselessAsync}
  alt="Resultado demo useless-async"
  style={{width: '95%'}}
/>

<Footer/>

---

# 2. Evita los await dentro de los bucles

<Footer/>

---

# 3. Usa Promise.all siempre que puedas
## Promise.allSettled también existe

<Footer/>

---

# 4. Si no sabes cuántas promesas vas a tener en un Promise.all usa p-map y limita la concurrencia

<Footer/>

---

# 5. Los async iterators pueden ser maravillosos

<Footer/>

---

# 6. Cachear queries

<Footer/>

---

# 7. Haz caso de los warnings

<Footer/>

---

<CodeSurfer>

  ```shell
  (node) warning: possible EventEmitter memory leak detected.
  11 listeners added.
  Use emitter.setMaxListeners() to increase limit.
  ```

</CodeSurfer>

<Footer/>

---

<CodeSurfer>


  ```js showNumbers
  console.log(1);
  console.log(2);
  console.log(3);
  ```

  ```diff 1
  ```

  ```diff 2
  ```

  ```diff 3
  ```

</CodeSurfer>

<Footer/>

---

# Documentación

- [Componentes de MDX Deck](https://github.com/jxnblk/mdx-deck/blob/73b90eb9a353d300cc9e5ddf3070bb6868298275/docs/components.md)
- [Layout de MDX Deck](https://github.com/jxnblk/mdx-deck/blob/73b90eb9a353d300cc9e5ddf3070bb6868298275/docs/layouts.md)
- [Code Surfer](https://codesurfer.pomb.us)

<Footer/>
